"""
## **Step 1: Setup Environment & Clone Repository**
"""

# %% [code]
# @title Install Dependencies
!pip install -q matplotlib numpy tqdm onnx onnxruntime onnxscript 
!pip install torch torchvision ftfy regex tqdm clip-anytorch pillow torchdiffeq

# Check CUDA
import torch
print(f"? PyTorch version: {torch.__version__}")
print(f"? CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"? CUDA device: {torch.cuda.get_device_name(0)}")
    print(f"? GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1e9:.2f} GB")

# %% [code]
# @title Clone Your Repository
import os
import sys
from pathlib import Path
from google.colab import drive

# Clone your repository
repo_url = "https://github.com/wwebtvmedia/enhancedoptimaltransport.git"
repo_dir = "/enhancedoptimaltransport"

if not os.path.exists(repo_dir):
    !git clone {repo_url} {repo_dir}
    print(f"? Repository cloned to {repo_dir}")
else:
    !cd {repo_dir} && git pull
    print(f"? Repository updated at {repo_dir}")

!python {repo_dir}/main.py
"""
## **Step 1: Setup Environment & Clone Repository**
"""

# %% [code]
# @title Install Dependencies
!pip install -q matplotlib numpy tqdm onnx onnxruntime onnxscript 
!pip install torch torchvision ftfy regex tqdm clip-anytorch pillow torchdiffeq

# Check CUDA
import torch
print(f"? PyTorch version: {torch.__version__}")
print(f"? CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"? CUDA device: {torch.cuda.get_device_name(0)}")
    print(f"? GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1e9:.2f} GB")

# %% [code]
# @title Clone Your Repository
import os
import sys
from pathlib import Path
from google.colab import drive

# Clone your repository
repo_url = "https://github.com/wwebtvmedia/enhancedoptimaltransport.git"
repo_dir = "/enhancedoptimaltransport"

if not os.path.exists(repo_dir):
    !git clone {repo_url} {repo_dir}
    print(f"? Repository cloned to {repo_dir}")
else:
    !cd {repo_dir} && git pull
    print(f"? Repository updated at {repo_dir}")

!python {repo_dir}/main.py
"""
## **Step 1: Setup Environment & Clone Repository**
"""

# %% [code]
# @title Install Dependencies
!pip install -q matplotlib numpy tqdm onnx onnxruntime onnxscript 
!pip install torch torchvision ftfy regex tqdm clip-anytorch pillow torchdiffeq

# Check CUDA
import torch
print(f"? PyTorch version: {torch.__version__}")
print(f"? CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"? CUDA device: {torch.cuda.get_device_name(0)}")
    print(f"? GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1e9:.2f} GB")

# %% [code]
# @title Clone Your Repository
import os
import sys
from pathlib import Path
from google.colab import drive

# Clone your repository
repo_url = "https://github.com/wwebtvmedia/enhancedoptimaltransport.git"
repo_dir = "/enhancedoptimaltransport"

if not os.path.exists(repo_dir):
    !git clone {repo_url} {repo_dir}
    print(f"? Repository cloned to {repo_dir}")
else:
    !cd {repo_dir} && git pull
    print(f"? Repository updated at {repo_dir}")

!python {repo_dir}/main.py